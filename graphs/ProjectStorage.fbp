INPORT=SplitDb.IN:DB
INPORT=Dispatch.IN:IN
OUTPORT=MergeContext.OUT:CONTEXT

# Route opening requests
'open,save' -> ROUTES Dispatch(routers/GroupRouter)
Dispatch ROUTE -> START Loading(ui/CreateLoadingContext)
Loading OUT -> IN MergeContext(core/Merge)
Dispatch MISSED -> IN ShowErrors(core/Output)

# Pass database connection to persistence handlers
SplitDb(core/Split) OUT -> DB LoadData(ui/LoadProjectData)

# Send all projects to the UI
'' -> START CreateProjectsCtx(objects/CreateObject)
CreateProjectsCtx OUT -> CONTEXT SetProjects(ui/SetToContext)
'projects' -> KEY SetProjects
LoadData PROJECTS -> VALUE SetProjects CONTEXT -> IN MergeContext

# Pass data to project context builder
LoadData PROJECTS -> PROJECTS PopulateProjectData(ui/PopulateProjectData)
Dispatch OUT[0] -> IN PopulateProjectData
PopulateProjectData OUT -> IN MergeContext

# Persistence
#LoadData PROJECTS -> PROJECTS Save(ui/Save)
SplitDb OUT -> DB Save(ui/Save)
Dispatch OUT[1] -> IN Save
Save OUT -> IN MergeContext

LoadData ERROR -> IN ShowErrors
