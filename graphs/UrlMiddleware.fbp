INPORT=Dispatch.IN:ACTION
OUTPORT=Passed.OUT:PASS
OUTPORT=NewActions.OUT:ACTION

'application:start,application:redirect' -> ROUTES Dispatch(ui/DispatchAction)

# Pass actions we don't care about onwards
Dispatch PASS -> IN Passed(core/Merge)

# New actions generated by this middleware
'application:url' -> ACTION ApplicationUrlAction(ui/SetAction)
ApplicationUrlAction OUT -> IN NewActions(core/Merge)

# Application start-up
Dispatch HANDLE[0] -> IN InitialURL(ui/GetUrl)
# Send application URL out
InitialURL OUT -> ApplicationUrlAction
# Subscribe to hash changes and generate new actions
InitialURL OUT -> START ListenHash(interaction/ListenHash)
ListenHash INITIAL -> URL HashToAction(ui/Router)
ListenHash CHANGE -> URL HashToAction
HashToAction ROUTE -> IN NewActions

# URL redirection. Changes URL and as side-effect stops app
Dispatch HANDLE[1] -> IN Redirect(ui/SetUrl)
